//DFPS2IVP JOB 60798,E002884,CLASS=W,NOTIFY=ROSCAAO,MSGCLASS=Q
//********************************************************************* 00100000
//*                                                                     00150000
//*PROPRIETARY V3 STATEMENT                                             00200000
//*LICENSED MATERIALS - PROPERTY OF IBM                                 00250000
//*5650-ZOS                                                             00350000
//*COPYRIGHT IBM CORP. 1997,2019                                        00400001
//*END PROPRIETARY V3 STATEMENT                                         00450000
//*                                                                     00500000
//********************************************************************* 00550000
//*     IVP FOR 31-BIT VSAM FUNCTION AND THE 31-BIT VIO FUNCTION        00600000
//*                SMS MANAGED VERSION   7/20/2000                      00650000
//********************************************************************* 00700000
//*                                                                     00750000
//*  NOTE: THIS JOB SHOULD BE RUN ONLY ON A SYSTEM THAT HAS STORAGE     00800000
//*  MANAGEMENT SUBSYSTEM (SMS) ACTIVE.                                 00850000
//*                                                                     00900000
//*  YOU MAY NEED TO MAKE CHANGES TO THIS JCL TO EXECUTE ON YOUR SYSTEM 00950000
//*                                                                     01000000
//*  THE FOLLOWING STRINGS REPRESENT CHANGES YOU MAY WANT TO MAKE:      01050000
//*                                                                     01100000
//*    TMP011    -    AN SMS MANAGED VOLUME                             01200000
//*    SUPCLONE   -    A GUARANTEED SPACE STORAGE CLASS                  0125000
//*                      THAT INCLUDES THE VOLUME TMP011                01300000
//*    CATALOG.ZOS24.MASTER  -    THE NAME OF THE MASTER CATALOG
//*                                                                     01450000
//********************************************************************* 01500000
//* THE DFP IVP CONSISTS OF THREE JOBS WITH VARIOUS STEPS TO VERIFY     01550000
//* THE 31-BIT VSAM FUNCTION AND THE 31-BIT VIO FUNCTION.               01600000
//********************************************************************* 01650000
//* JOBSTEPS:                                                           01700000
//*                                                                     01750000
//* JOB1: DFPS2IVP                                                      01800000
//*      DELETE1  -- DELETE TEMPORARY LOAD LIBRARY.  (CLEANUP)          01850000
//*      CLEANUP1 -- CLEANUP ICF CATALOG AND ANY VSAM DATASETS.         01950000
//*      DEFCAT   -- DEFINE DFS2UCAT ON SCRATCH PACK.        (3 CYL)    02000000
//*      CREATE   -- CREATE TEMPORARY LOAD LIBRARY.                     02025000
//*      HOLD1    -- IEBGENER UTILITY TO HOLD THE NEXT JOB.             02050000
//*                                                                     02100000
//* JOB2: DFPS2IV2                                                      02150000
//*      DEFKSDS  -- DEFINE CLUSTER DFPS2IVP.KSDS01.         (10 TRK)   02200000
//*      ASSEM1   -- ASSEMBLE 3 VSAM 31-BIT PROGRAMS (DFPSIVP1,         02250000
//*      ASSEM2      DFPSIVP2, & DFPSIVP3) TO TEST MULTIPLE LSR POOLS.  02300000
//*      ASSEM3     (NOTE: ANY AVAILABLE ASSEMBLER CAN BE USED)         02350000
//*      LINK1    -- LINK-IN 3 TEST PROGRAMS.                           02400000
//*      HOLD2    -- IEBGENER UTILITY TO HOLD THE NEXT JOB.             02450000
//*                                                                     02500000
//* JOB3: DFPS2IV3                                                      02550000
//*      EXECIVP1 -- EXECUTE DFPSIVP1 PROGRAM.                          02600000
//*      EXECIVP2 -- EXECUTE DFPSIVP2 PROGRAM.                          02650000
//*      EXECIVP3 -- EXECUTE DFPSIVP3 PROGRAM.                          02700000
//*      LINK2    -- LINK-IN OBJECT DECK FOR 31-BIT VIO TEST            02750000
//*      VIOTEST  -- EXECUTE VIO 31-BIT VIO PROGRAM.                    02800000
//*      CLEANUPT -- DELETE TEMPORARY LOAD LIBRARY                      02837500
//*      CLEANUP2 -- DELETE ICF CATALOG WITH DFPS2IVP.KSDS01.           02875000
//*                                                                     02912500
//********************************************************************  02950000
//*                                                                     03000000
//*      NORMAL COMPLETION RESULTS:                                     03050000
//*                 ALL STEPS SHOULD HAVE ZERO RETURN CODES.            03100000
//*                                                                     03150000
//*      ABNORMAL COMPLETION RESULTS:                                   03200000
//*                 USER 100 ABENDS ARE ISSUED FOR ANY ERROR RETURN     03250000
//*                     CODES FROM VSAM AND FROM VIO.                   03300000
//*                 USER 0001 ABEND MAY BE ISSUED FROM THE        @P1A  03310001
//*                     VIOTEST STEP IF THE VIO DATA SET          @P1A  03320001
//*                     REFERENCED IN THAT STEP IS NOT ACTUALLY   @P1A  03330001
//*                     ALLOCATED TO VIO.                         @P1A  03340001
//*                                                                     03350000
//********************************************************************  03400000
//* SETUP:                                                              03450000
//*       THE USER MUST FIRST MOUNT A SMS MANAGED VOLUME.               03500000
//*       A SCRATCH VOLUME IS DEFINED AS A volume that does not         03550000
//*       HAVE ANY DATA SETS THAT WILL REQUIRE further use.             03600000
//*                                                                     03700000
//*       IN THE FOLLOWING JOBSTREAM, SUBSTITUTE DEVICES AND MASTER     03750000
//*       CATALOG NAME INDICATED BY THE COMMENT FLAGS.                  03800000
//********************************************************************* 03850000
//* CHANGE ACTIVITY =                                                   03900000
//*                                                                     03950000
//* ADD DROP STATEMENT BEFORE CHANGING BASE REGISTERS AND               04000000
//* CORRECT PARAMETERS                                        @WA24440* 04050000
//* ADD HLASMC                                                @WA29697* 04068700
//* FIXED HLASMC SYNTAX                                           @01C* 04087500
//* $P1,R100842,HDZ2240,2018JUN12,RLUNGER:  ADD U0001 ABEND DOC   @P1A* 04087601
//*     TO ABNORMAL COMPLETION RESULTS.                           @P1A* 04087701
//********************************************************************* 04100000
//*                                                                   * 04150000
//*        DELETE TEMPORARY LOAD MODULE LIBARARY IF EXISTING          * 04200000
//*                                                                   * 04250000
//********************************************************************* 04300000
//*                                                                     04350000
//DELETE1 EXEC PGM=IEFBR14                                              04400000
//LOADDD   DD  DSN=DFPS2IVP.TEMPLIB,DISP=(MOD,DELETE),                  04450000
//             SPACE=(TRK,(0)),STORCLAS=SUPCLONE,                        0450000
//             UNIT=SYSDA,VOL=SER=TMP011             /*              */ 04550000
//*                                                                     05150000
//********************************************************************* 05200000
//*                                                                   * 05250000
//* CLEANUP ICF CATALOG AND ANY VSAM DATASETS FROM SCRATCH PACK.      * 05300000
//*                                                                   * 05350000
//********************************************************************* 05400000
//*                                                                     05450000
//CLEANUP1 EXEC PGM=IDCAMS                                              05500000
//SYSPRINT DD  SYSOUT=*                                                 05550000
//SYSIN    DD  *                                                        05600000
 /********************************************************************/ 05650000
 /*  CLEANUP1  DELETE THE CLUSTER AND ICF CATALOG THAT MAY HAVE BEEN */ 05700000
 /*            PREVIOUSLY DEFINED.  EXPECT A NON-ZERO RETURN CODE IF */ 05750000
 /*            THEY DON'T EXIST.                                     */ 05800000
 /********************************************************************/ 05850000
  DELETE (DFPS2IVP.KSDS01) PURGE                                        05900000
                                                                        05950000
  DELETE DFS2UCAT UCAT FORCE                                            06000000
                                                                        06050000
  EXPORT DFS2UCAT DISCONNECT                     /*@YA22710*/           06100000
                                                                        06150000
  SET LASTCC=0                                                          06200000
  SET MAXCC=0                                                           06250000
/*                                                                      06300000
//*                                                                     06350000
//********************************************************************* 06400000
//*                                                                   * 06450000
//* DEFINE AN ICF USERCATLOG AND AN ALIAS. EXPECT ZERO RETURN CODE.   * 06500000
//*                                                                   * 06550000
//********************************************************************* 06600000
//*                                                                     06650000
//DEFCAT EXEC PGM=IDCAMS                                                06700000
//VOLUME    DD   VOL=SER=TMP011,UNIT=SYSDA,DISP=OLD   /*SMS IVPVOL*/    06750000
//SYSPRINT  DD   SYSOUT=*                                               06800000
//SYSIN    DD   *                                                       06850000
  /**********************************************************/          06900000
  /*  DEFCAT DEFINE AN ICF USERCATALOG IN AN SMS-MANAGED    */          06950000
  /*         VOLUME USING A GUARANTEED SPACE STORAGE CLASS. */          07000000
  /*         EXPECT SUCCESSFUL COMPLETION OF THIS DEFINE.   */          07050000
  /**********************************************************/          07100000
         DEFINE  UCAT  (  -                                             07150000
               NAME (DFS2UCAT)  -                                       07200000
               ICFCATALOG -                                             07250000
               VOL (TMP011)        /*SMS IVPVOL*/ -                     07350000
               STORCLAS(SUPCLONE)   /* GUARANTEED SPACE STORAGE CLS*/-   0740000
               FILE (VOLUME)   -                                        07450000
               RECSZ (4086 32400) -                                     07500000
               CYL (1 1))  -                                            07550000
      CATALOG (CATALOG.ZOS24.MASTER)              /*MASTERCAT*/
                                                                        07650000
  /**********************************************************/          07700000
  /*  DEFINE AN ALIAS OF THE ICF USERCATALOG.               */          07750000
  /*  EXPECT SUCCESSFUL COMPLETION OF THIS DEFINE.          */          07800000
  /**********************************************************/          07850000
         DEFINE ALIAS ( NAME ( DFPS2IVP) RELATE (DFS2UCAT))             07900000
/*                                                                      07950000
//********************************************************************* 07954100
//*                                                                   * 07958200
//*           CREATE NEW LOAD MODULE LIBRARY DFPS2IVP.TEMPLIB.        * 07962300
//*                                                                   * 07966400
//********************************************************************* 07970500
//*                                                                     07974600
//CREATE  EXEC PGM=IEFBR14                          /*              */  07978700
//LOADDD DD DSN=DFPS2IVP.TEMPLIB,UNIT=SYSDA,VOL=SER=TMP011,             07982800
//          DCB=(SYS1.LINKLIB),STORCLAS=SUPCLONE,                        0798690
//          SPACE=(TRK,(5,2,1),RLSE),DISP=(NEW,KEEP)                    07991000
//*                                                                     07995100
//********************************************************************* 08000000
//*   THE FOLLOWING STEP WILL HOLD THE NEXT JOB(S) FROM BEING         * 08050000
//*   SUBMITTED UNTIL THE PRECEDING JOB IS COMPLETELY EXECUTED.       * 08100000
//********************************************************************* 08150000
//HOLD1   EXEC PGM=IEBGENER                                             08200000
//SYSPRINT DD  SYSOUT=*                                                 08250000
//SYSIN  DD  DUMMY                                                      08300000
//SYSUT2  DD SYSOUT=(A,INTRDR)                                          08350000
//SYSUT1  DD DATA,DLM=$A                                                08400000
//DFPS2IV2 JOB (DFPS2IV2),IVP2,MSGLEVEL=(1,1),MSGCLASS=A,CLASS=A        08450000
//*                                                                     08500000
//********************************************************************* 08550000
//*                                                                   * 08600000
//*     DEFINE DFPS2IVP.KSDS01 IN A SMS-MANAGED VOLUME.               * 08650000
//*                                                                   * 08700000
//********************************************************************* 08750000
//*                                                                     08800000
//DEFKSDS EXEC PGM=IDCAMS                                               08850000
//SYSPRINT DD  SYSOUT=*                                                 08900000
//VOLUME   DD  UNIT=SYSDA,VOL=SER=TMP011,DISP=OLD     /*SMS IVPVOL*/    08950000
//SYSIN    DD  *                                                        09000000
 /***********************************************************/          09050000
 /*  DEFKSDS  DEFINE A KSDS IN AN SMS-MANAGED VOLUME USING  */          09100000
 /*           A GUARANTEED STORAGE CLASS. THE CLUSTER WILL  */          09150000
 /*           BE CATALOGED IN THE ICF CATALOG POINTED TO    */          09200000
 /*           BY ITS HLQ WHICH IS AN ALIAS TO THE CATALOG.  */          09250000
 /*           EXPECT SUCCESSFUL COMPLETION OF THIS DEFINE.  */          09300000
 /***********************************************************/          09350000
         DEFINE CLUSTER ( NAME (DFPS2IVP.KSDS01)    -                   09400000
                          VOLUMES (TMP011)    /*SMS IVPVOL*/  -         09450000
                          STORCLAS(SUPCLONE)   /* GS STORAGE CLS*/-      0950000
                          TRK  (10 1)    -                              09550000
                          RECSZ (256 256)   -                           09600000
                          CISZ (2048)    -                              09650000
                          KEYS (4 8)  -                                 09700000
                          FILE (VOLUME)  -                              09750000
                          SHR (3 3)  -                                  09850000
                          OWNER  (VSM31BIT) ) -                         09900000
                          DATA ( NAME (DFPS2IVP.KSDS01.DATA) )  -       09950000
                          INDEX ( NAME (DFPS2IVP.KSDS01.INDEX) )        10000000
/*                                                                      10050000
//*                                                                     10100000
//********************************************************************* 10150000
//*                                                                   * 10200000
//*           ASSEMBLE DFPSIVP1                                       * 10250000
//*                                                                   * 10300000
//********************************************************************* 10350000
//*                                                                     10400000
//ASSEM1  EXEC HLASMC,REGION.C=512K,COND.C=(0,NE,DEFKSDS), /*@WA29697*/ 10450000
//             PARM.C='NOOBJECT,LINECOUNT(55),DECK'        /*@WA24440*/ 10500000
//C.SYSPUNCH DD  DSN=&ASM1OBJ,UNIT=SYSDA,DISP=(NEW,PASS),  /*@YA06851*/ 10550000
//             SPACE=(TRK,(1,1),RLSE)                                   10600000
//C.SYSIN    DD  *                                         /*@YA06851*/ 10650000
DFPSIVP1 TITLE 'VSAM 31 BIT MULTIPLE LSR POOLS TEST'                    10700000
DFPSIVP1 CSECT                                                          10750000
DFPSIVP1 AMODE 31                                                       10800000
DFPSIVP1 RMODE 24                                                       10850000
*                                                                       10900000
*--------------------------------------------------------------------*  10950000
*                                                                    *  11000000
*        REGISTER EQUATES.                                           *  11050000
*                                                                    *  11100000
*--------------------------------------------------------------------*  11150000
*                                                                       11200000
R0       EQU   0                       REGISTER 0.                      11250000
COUNT    EQU   2                       LOOP ITERATION COUNTER.          11300000
KEYREG   EQU   3                       SEARCH KEY ARGUMENT REGISTER.    11350000
KEYINDEX EQU   4                       KEY TABLE INDEX.                 11400000
LINKREG  EQU   11                      INTERNAL SUBROUTINE LINKAGE.     11450000
BASEREG  EQU   12                      BASE REGISTER.                   11500000
SAVEREG  EQU   13                      SAVE AREA REGISTER.              11550000
RETREG   EQU   14                      CALLER'S RETURN ADDRESS.         11600000
ENTRYREG EQU   15                      DFPSIVP1'S ENTRY ADDRESS.        11650000
RETCODE  EQU   15                      RETURN CODE.                     11700000
         EJECT                                                          11750000
*                                                                       11800000
*--------------------------------------------------------------------*  11850000
*                                                                    *  11900000
*        CONSTANT EQUATES                                            *  11950000
*                                                                    *  12000000
*--------------------------------------------------------------------*  12050000
*                                                                       12100000
POOL24   EQU   5                       RESOURCE POOL ID BELOW 16MB.     12150000
POOL31   EQU   15                      RESOURCE POOL ID ABOVE 16MB.     12200000
KEYINCR  EQU   1                       KEY INCREMENT.                   12250000
NORECS   EQU   50                      NUMBER OF RECORDS TO BE LOADED.  12300000
KEYLENG  EQU   4                       SEARCH ARGUMENT LENGTH.          12350000
RECLENG  EQU   256                     RECORD LENGTH.                   12400000
LOOPCNT  EQU   5                       KSDS VERIFY LOOP COUNT.          12450000
         EJECT                                                          12500000
*                                                                       12550000
*--------------------------------------------------------------------*  12600000
*                                                                    *  12650000
*        STANDARD ENTRY PROLOGUE. SAVE AREA CHAINING, ESTABLISH      *  12700000
*        BASE REGISTER AND ADDRESSIBILITY.                           *  12750000
*                                                                    *  12800000
*--------------------------------------------------------------------*  12850000
*                                                                       12900000
         USING DFPSIVP1,ENTRYREG       ESTABLISH ADDRESSIBILITY.        12950000
         B     PROLOGUE                BRANCH AROUND EYECATCHER.        13000000
         DC    CL8'DFPSIVP1'           MODULE NAME.                     13050000
         DC    CL8'&SYSDATE'           ASSEMBLE DATE.                   13100000
PROLOGUE STM   RETREG,BASEREG,12(SAVEREG)  SAVE CALLER'S REGISTERS.     13150000
         BALR  BASEREG,R0              ESTABLISH BASE REGISTER.         13200000
         DROP ENTRYREG                 DROP INITIAL BASE REG @WA24440   13250000
         USING *,BASEREG               ESTABLISH ADDRESSIBILTY          13300000
         LA    ENTRYREG,SAVEAREA       POINT TO MY SAVE AREA.           13350000
         ST    SAVEREG,4(,ENTRYREG)    SAVE ADDRESS OF CALLER'S SAVE    13400000
*                                          AREA.                        13450000
         ST    ENTRYREG,8(,SAVEREG)    SAVE ADDRESS OF MY SAVE AREA.    13500000
         LR    SAVEREG,ENTRYREG        POINT TO MY SAVE AREA.           13550000
         EJECT                                                          13600000
*                                                                       13650000
*--------------------------------------------------------------------*  13700000
*                                                                    *  13750000
*        BUILD VIRTUAL RESOURCE POOLS ABOVE AND BELOW 16MB LINE.     *  13800000
*                                                                    *  13850000
*--------------------------------------------------------------------*  13900000
*                                                                       13950000
BUILD1   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     14000000
         BLDVRP MF=(E,BLDABOVE)        GET RESOURCE POOL ABOVE 16MB.    14050000
         LTR   RETCODE,RETCODE         REQUEST COMPLETED?               14100000
         BZ    BUILD2                  YES, GO BUILD POOL BELOW 16MB.   14150000
         ABEND 100                     NO, ABEND WITH CODE U0100.       14200000
BUILD2   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     14250000
         BLDVRP MF=(E,BLDBELOW)        GET RESOURCE POOL BELOW 16MB.    14300000
         LTR   RETCODE,RETCODE         REQUEST COMPLETED?               14350000
         BZ    OPEN1                   YES, GO OPEN KSDS01.             14400000
         ABEND 100                     NO, ABEND WITH CODE U0100.       14450000
         EJECT                                                          14500000
*                                                                       14550000
*--------------------------------------------------------------------*  14600000
*                                                                    *  14650000
*        OPEN DFPS2IVP.KSDS01 FOR OUTPUT.                            *  14700000
*                                                                    *  14750000
*--------------------------------------------------------------------*  14800000
*                                                                       14850000
OPEN1    DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     14900000
         OPEN  (SEQACB1)               LOGICALLY CONNECT KSDS01.        14950000
         LTR   RETCODE,RETCODE         KSDS01 OPEN OK?                  15000000
         BZ    OPEN1OK                 YES, GO LOAD DATASET.            15050000
         ABEND 100                     NO, ABEND WITH CODE U0100.       15100000
*                                                                       15150000
*--------------------------------------------------------------------*  15200000
*                                                                    *  15250000
*        CALL SUBROUTINE TO LOAD DFPS2IVP.KSDS01.                    *  15300000
*                                                                    *  15350000
*--------------------------------------------------------------------*  15400000
*                                                                       15450000
OPEN1OK  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     15500000
         BAL   LINKREG,LOADIT          CALL SUBROUTINE TO LOAD KSDS01.  15550000
         LTR   RETCODE,RETCODE         KSDS01 LOAD OK?                  15600000
         BZ    LOADOK                  YES, GO CLOSE KSDS01.            15650000
         ABEND 100                     NO, ABEND WITH CODE U0100.       15700000
LOADOK   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     15750000
         CLOSE (SEQACB1)               LOGICALLY DISCONNECT KSDS01.     15800000
         LTR   RETCODE,RETCODE         KSDS01 CLOSE OK?                 15850000
         BZ    OPEN2                   YES, GO RE-OPEN KSDS01.          15900000
         ABEND 100                     NO, ABEND WITH CODE U0100.       15950000
         EJECT                                                          16000000
*                                                                       16050000
*--------------------------------------------------------------------*  16100000
*                                                                    *  16150000
*        OPEN DFPS2IVP.KSDS01 TO VERIFY RECORDS ARE ACCESSIBLE.      *  16200000
*                                                                    *  16250000
*--------------------------------------------------------------------*  16300000
*                                                                       16350000
OPEN2    DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     16400000
         OPEN  (SEQACB2)               LOGICALLY CONNECT KSDS01.        16450000
         LTR   RETCODE,RETCODE         KSDS01 OPEN OK?                  16500000
         BZ    OPEN2OK                 YES, GO VERIFY DATASET.          16550000
         ABEND 100                     NO, ABEND WITH CODE U0100.       16600000
*                                                                       16650000
*--------------------------------------------------------------------*  16700000
*                                                                    *  16750000
*        CALL SUBROUTINE TO VERIFY DFPS2IVP.KSDS01 IS ACCESSIBLE.    *  16800000
*                                                                    *  16850000
*--------------------------------------------------------------------*  16900000
*                                                                       16950000
OPEN2OK  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     17000000
         LA    COUNT,LOOPCNT           GET NUMBER OF TIMES TO VERIFY    17050000
*                                          DATASET.                     17100000
VERLOOP  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     17150000
         BAL   LINKREG,VERIFYIT        CALL SUBROUTINE TO VERIFY        17200000
*                                          DFPS2IVP.KSDS01.             17250000
         BCT   COUNT,VERLOOP           EXECUTE VERIFY SUBROUTINE        17300000
*                                          UNTIL LOOP COUNT IS ZERO.    17350000
         CLOSE (SEQACB2)               LOGICALLY DISCONNECT KSDS01.     17400000
         LTR   RETCODE,RETCODE         KSDS01 CLOSE OK?                 17450000
         BZ    DELPOOL1                YES, GO DELETE RESOURCE POOLS.   17500000
         ABEND 100                     NO, ABEND WITH CODE U0100.       17550000
         EJECT                                                          17600000
*                                                                       17650000
*--------------------------------------------------------------------*  17700000
*                                                                    *  17750000
*        DELETE RESOURCE POOLS AND TEST FOR SUCCESSFUL RUN.          *  17800000
*                                                                    *  17850000
*--------------------------------------------------------------------*  17900000
*                                                                       17950000
DELPOOL1 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     18000000
         DLVRP TYPE=LSR,SHRPOOL=POOL24 DELETE POOL BELOW 16MB.          18050000
         LTR   RETCODE,RETCODE         RESOURCE POOL DELETE OK?         18100000
         BZ    DELPOOL2                YES, GO DELETE RESOURCE POOL31.  18150000
         ABEND 100                     NO, ABEND WITH CODE U0100.       18200000
DELPOOL2 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     18250000
         DLVRP TYPE=LSR,SHRPOOL=POOL31 DELETE POOL ABOVE 16MB.          18300000
         LTR   RETCODE,RETCODE         RESOURCE POOL DELETE OK?         18350000
         BZ    DELETEOK                YES, GO SET SUCCESS RETURN CODE. 18400000
         ABEND 100                     NO, ABEND WITH CODE U0100.       18450000
DELETEOK DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     18500000
         SR    RETCODE,RETCODE         SET ZERO RETURN CODE.            18550000
         EJECT                                                          18600000
*                                                                       18650000
*--------------------------------------------------------------------*  18700000
*                                                                    *  18750000
*        STANDARD EXIT EPILOGUE. RESTORE CALLER'S REGISTERS AND      *  18800000
*        RETURN TO CALLER.                                           *  18850000
*                                                                    *  18900000
*--------------------------------------------------------------------*  18950000
*                                                                       19000000
EXIT     DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     19050000
         L     SAVEREG,4(,SAVEREG)     RESTORE CALLER'S SAVE AREA ADDR. 19100000
         L     RETREG,12(,SAVEREG)     RESTORE RETURN ADDRESS REGISTER. 19150000
         LM    R0,BASEREG,20(SAVEREG)  RESTORE ALL REGS. EXCEPT REG15.  19200000
         BR    RETREG                  RETURN TO CALLER.                19250000
         EJECT                                                          19300000
*                                                                       19350000
*--------------------------------------------------------------------*  19400000
*                                                                    *  19450000
*        LOAD DFPS2IVP.KSDS01.                                       *  19500000
*                                                                    *  19550000
*--------------------------------------------------------------------*  19600000
*                                                                       19650000
LOADIT   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     19700000
         ST    LINKREG,LINKSAVE        SAVE RETURN ADDRESS.             19750000
         SR    KEYREG,KEYREG           ZERO SEARCH ARGUMENT REGISTER.   19800000
         SR    KEYINDEX,KEYINDEX       ZERO KEY TABLE INDEX.            19850000
         LA    COUNT,NORECS            GET NUMBER OF RECORDS TO LOAD.   19900000
*                                                                       19950000
LOADLOOP DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     20000000
         ST    KEYREG,KEY              UPDATE KEY FIELD.                20050000
         STH   KEYREG,KEYTABLE(KEYINDEX)   INIT. RECORD KEY TABLE.      20100000
         PUT   RPL=SEQRPL1             WRITE RECORD.                    20150000
         LTR   RETCODE,RETCODE         REQUEST COMPLETED OK?            20200000
         BZ    PUTOK                   YES, GO SET UP NEXT RECORD.      20250000
         ABEND 100                     NO, ABEND WITH CODE U0100.       20300000
PUTOK    DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     20350000
         LA    KEYINDEX,2(,KEYINDEX)   INCREMENT KEY TABLE INDEX.       20400000
         LA    KEYREG,KEYINCR(,KEYREG) INCREMENT KEY.                   20450000
         BCT   COUNT,LOADLOOP          DECREMENT COUNT. COUNT ZERO?     20500000
*                                      NO, LOOP AGAIN.                  20550000
         SR    RETCODE,RETCODE         SET ZERO RETURN CODE.            20600000
         L     LINKREG,LINKSAVE        YES, RESTORE RETURN ADDRESS.     20650000
         BR    LINKREG                 RETURN TO MAIN ROUTINE.          20700000
         EJECT                                                          20750000
*                                                                       20800000
*--------------------------------------------------------------------*  20850000
*                                                                    *  20900000
*        VERIFY DFPS2IVP.KSDS01 CAN BE ACCESSED. GET RECORDS USING   *  20950000
*        SEQUENTIAL REQUESTS. COMPARE THE RECORDS READ WITH A MODEL  *  21000000
*        RECORD.  IF THE RECORDS MATCH THE LOOP IS EXECUTED AGAIN,   *  21050000
*        IF THE COMPARISON IS UNEQUAL A USER 100 ABEND IS ISSUED.    *  21100000
*        THE DATASET IS READ UNTIL EOF IS REACHED, AND THEN          *  21150000
*        TEMPORARILY CLOSED.  CONTROL IS THEN RETURNED TO MAIN       *  21200000
*        ROUTINE.                                                    *  21250000
*                                                                    *  21300000
*--------------------------------------------------------------------*  21350000
*                                                                       21400000
         EJECT                                                          21450000
VERIFYIT DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     21500000
         ST    LINKREG,LINKSAVE        SAVE RETURN ADDRESS.             21550000
         SR    KEYINDEX,KEYINDEX       INITIALIZE KEY TABLE INDEX.      21600000
         SR    KEYREG,KEYREG           INIT. SEARCH ARGUMENT REGISTER.  21650000
         ST    KEYREG,KEY              UPDATE SEARCH ARGUMENT FIELD.    21700000
         POINT RPL=SEQRPL2             POSITION VSAM.                   21750000
         LTR   RETCODE,RETCODE         POINT REQUEST ACCEPTED?          21800000
         BZ    GETLOOP                 YES, GO GET RECORD.              21850000
         ABEND 100                     NO, ABEND WITH CODE U0100.       21900000
GETLOOP  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     21950000
         LH    KEYREG,KEYTABLE(KEYINDEX) GET SEARCH KEY ARGUMENT.       22000000
         ST    KEYREG,KEY              UPDATE SEARCH ARGUMENT FIELD.    22050000
         MVC   TESTREC(RECLENG),RECORD INITIALIZE COMPARISON RECORD.    22100000
         GET   RPL=SEQRPL2             GET RECORD USING SEQ. REQUEST.   22150000
         LTR   RETCODE,RETCODE         REQUEST ACCEPTED?                22200000
         BZ    COMPARE1                YES, GO COMPARE RECORD.          22250000
         ABEND 100                     NO, ABEND WITH CODE U0100.       22300000
COMPARE1 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     22350000
         CLC   TESTREC(RECLENG),RECORD     ARE RECORDS EQUAL?           22400000
         BE    BUMPKEY                 YES, GO INCREMENT KEY TABLE IX.  22450000
         ABEND 100                     NO, ABEND WITH CODE U0100.       22500000
BUMPKEY  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     22550000
         LA    KEYINDEX,2(,KEYINDEX)   POINT TO NEXT KEY OF RECORD TO   22600000
*                                          COMPARE.                     22650000
         B     GETLOOP                 GO GET NEXT RECORD.              22700000
*                                      IS COUNT ZERO? NO, CONTINUE.     22750000
TCLOSE   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     22800000
         CLOSE (SEQACB2),TYPE=T        YES, PARTIALLY CLOSE KSDS01.     22850000
         LTR   RETCODE,RETCODE         KSDS01 CLOSE OK?                 22900000
         BZ    TCLOSEOK                YES, GO RETURN TO MAIN ROUTINE.  22950000
         ABEND 100                     NO, ABEND WITH CODE U0100.       23000000
TCLOSEOK DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     23050000
         L     LINKREG,LINKSAVE        RESTORE RETURN ADDRESS.          23100000
         BR    LINKREG                 RETURN TO MAIN ROUTINE.          23150000
         EJECT                                                          23200000
*                                                                       23250000
*--------------------------------------------------------------------*  23300000
*                                                                    *  23350000
*        CONSTANT AND STORAGE DEFINITIONS.                           *  23400000
*                                                                    *  23450000
*--------------------------------------------------------------------*  23500000
*                                                                       23550000
KEYTABLE DC    (NORECS)AL2(0)          RECORD KEY TABLE.                23600000
*                                                                       23650000
OPENMSG  DS    CL132                   OPEN ERROR MESSAGE AREA.         23700000
*                                                                       23750000
         DS    0F                      FULLWORD BOUNDARY ALIGNMENT.     23800000
TESTREC  DS    CL256                   RECORD COMPARISON MODEL.         23850000
*                                                                       23900000
         DS    0F                      FULLWORD BOUNDARY ALIGNMENT.     23950000
RECORD   DS    0CL256                  KSDS01 RECORD DESCRIPTION.       24000000
         DC    CL8'DFPS2IVP'           TESTCASE NAME.                   24050000
KEY      DC    F'0'                    SEARCH KEY ARGUMENT.             24100000
         DC    CL4' '                  FILLER.                          24150000
         DC    4CL60' TEST DATA FOR DFPS2IVP'  FILLER.                  24200000
*                                                                       24250000
LINKSAVE DC    F'-1'                   INTERNAL LINKAGE RETURN ADDR.    24300000
*                                                                       24350000
SAVEAREA DC    18F'-1'                 REGISTER SAVE AREA.              24400000
         EJECT                                                          24450000
*                                                                       24500000
*--------------------------------------------------------------------*  24550000
*                                                                    *  24600000
*        VSAM CONTROL BLOCKS.                                        *  24650000
*                                                                    *  24700000
*--------------------------------------------------------------------*  24750000
*                                                                       24800000
BLDABOVE BLDVRP BUFFERS=(2048(4),4096(3),512(5)),                      X24850000
               KEYLEN=4,                                               X24900000
               STRNO=3,                                                X24950000
               TYPE=LSR,                                               X25000000
               SHRPOOL=15,                                             X25050000
               LOC=ANY,                                                X25100000
               MF=L                                                     25150000
         EJECT                                                          25200000
*                                                                       25250000
BLDBELOW BLDVRP BUFFERS=(2048(4),4096(3),512(6)),                      X25300000
               KEYLEN=4,                                               X25350000
               STRNO=3,                                                X25400000
               TYPE=LSR,                                               X25450000
               SHRPOOL=5,                                              X25500000
               LOC=BELOW,                                              X25550000
               MF=L                                                     25600000
         EJECT                                                          25650000
*                                                                       25700000
SEQACB1  ACB   AM=VSAM,                                                X25750000
               DDNAME=KSDS01,                                          X25800000
               BUFND=3,                                                X25850000
               BUFNI=2,                                                X25900000
               MACRF=(KEY,DDN,SEQ,OUT,AMODE31),                        X25950000
               SHRPOOL=POOL24,                                         X26000000
               MAREA=OPENMSG,                                          X26050000
               MLEN=132                                                 26100000
         EJECT                                                          26150000
*                                                                       26200000
SEQACB2  ACB   AM=VSAM,                                                X26250000
               DDNAME=KSDS01,                                          X26300000
               BUFND=3,                                                X26350000
               BUFNI=2,                                                X26400000
               MACRF=(KEY,DDN,SEQ,IN,LSR),                             X26450000
               SHRPOOL=POOL31,                                         X26500000
               MAREA=OPENMSG,                                          X26550000
               EXLST=EXLST1,                                           X26600000
               MLEN=132                                                 26650000
         EJECT                                                          26700000
*                                                                       26750000
SEQRPL1  RPL   AM=VSAM,                                                X26800000
               ACB=SEQACB1,                                            X26850000
               AREA=RECORD,                                            X26900000
               AREALEN=RECLENG,                                        X26950000
               ARG=KEY,                                                X27000000
               KEYLEN=KEYLENG,                                         X27050000
               OPTCD=(KEY,SEQ,FWD,SYN,NUP),                            X27100000
               RECLEN=RECLENG                                           27150000
         EJECT                                                          27200000
*                                                                       27250000
SEQRPL2  RPL   AM=VSAM,                                                X27300000
               ACB=SEQACB2,                                            X27350000
               AREA=RECORD,                                            X27400000
               AREALEN=RECLENG,                                        X27450000
               ARG=KEY,                                                X27500000
               OPTCD=(KEY,SEQ,FWD,SYN,NUP),                            X27550000
               RECLEN=RECLENG                                           27600000
         EJECT                                                          27650000
*                                                                       27700000
EXLST1   EXLST AM=VSAM,                                                X27750000
               EODAD=TCLOSE                                             27800000
*                                                                       27850000
         END                                                            27900000
/*                                                                      27950000
//*                                                                     28000000
//********************************************************************* 28050000
//*                                                                   * 28100000
//*           ASSEMBLE DFPSIVP2                                       * 28150000
//*                                                                   * 28200000
//********************************************************************* 28250000
//*                                                                     28300000
//ASSEM2 EXEC HLASMC,REGION.C=512K,COND.C=(0,NE,ASSEM1.C), /*@WA29697*/ 28350000
//             PARM.C='NOOBJECT,LINECOUNT(55),DECK'       /*@WA24440*/  28400000
//C.SYSPUNCH DD  DSN=&ASM2OBJ,UNIT=SYSDA,DISP=(NEW,PASS), /*@YA06851*/  28450000
//             SPACE=(TRK,(1,1),RLSE)                                   28500000
//C.SYSIN    DD  *                                        /*@YA06851*/  28550000
DFPSIVP2 TITLE 'DFPSIVP2 -- VSAM 31 BIT MULTIPLE LSR POOLS TEST'        28600000
DFPSIVP2 CSECT                                                          28650000
DFPSIVP2 AMODE 31                                                       28700000
DFPSIVP2 RMODE 24                                                       28750000
*                                                                       28800000
*--------------------------------------------------------------------*  28850000
*                                                                    *  28900000
*        REGISTER EQUATES.                                           *  28950000
*                                                                    *  29000000
*--------------------------------------------------------------------*  29050000
*                                                                       29100000
R0       EQU   0                       REGISTER 0.                      29150000
COUNT    EQU   2                       LOOP ITERATION COUNTER.          29200000
KEYREG   EQU   3                       SEARCH KEY ARGUMENT REGISTER.    29250000
MAXRECS  EQU   5                       MAXIMUM NO. OF RECORDS.          29300000
LINKREG  EQU   11                      INTERNAL SUBROUTINE LINKAGE.     29350000
BASEREG  EQU   12                      BASE REGISTER.                   29400000
SAVEREG  EQU   13                      SAVE AREA REGISTER.              29450000
RETREG   EQU   14                      CALLER'S RETURN ADDRESS.         29500000
ENTRYREG EQU   15                      DFPSIVP2'S ENTRY ADDRESS.        29550000
RETCODE  EQU   15                      RETURN CODE.                     29600000
         EJECT                                                          29650000
*                                                                       29700000
*--------------------------------------------------------------------*  29750000
*                                                                    *  29800000
*        CONSTANT EQUATES                                            *  29850000
*                                                                    *  29900000
*--------------------------------------------------------------------*  29950000
*                                                                       30000000
POOL24   EQU   5                       RESOURCE POOL ID BELOW 16MB.     30050000
POOL31   EQU   15                      RESOURCE POOL ID ABOVE 16MB.     30100000
NORECS   EQU   50                      NUMBER OF RECORDS TO BE LOADED.  30150000
KEYLENG  EQU   4                       SEARCH ARGUMENT LENGTH.          30200000
RECLENG  EQU   256                     RECORD LENGTH.                   30250000
LOOPCNT  EQU   10                      KSDS-LOAD LOOP COUNT.            30300000
CLOCKOK  EQU   12                      TIME OK MASK.                    30350000
         EJECT                                                          30400000
*                                                                       30450000
*--------------------------------------------------------------------*  30500000
*                                                                    *  30550000
*        STANDARD ENTRY PROLOGUE. SAVE AREA CHAINING, ESTABLISH      *  30600000
*        BASE REGISTER AND ADDRESSIBILITY.                           *  30650000
*                                                                    *  30700000
*--------------------------------------------------------------------*  30750000
*                                                                       30800000
         USING DFPSIVP2,ENTRYREG       ESTABLISH ADDRESSIBILITY.        30850000
         B     PROLOGUE                BRANCH AROUND EYECATCHER.        30900000
         DC    CL8'DFPSIVP2'           MODULE NAME.                     30950000
         DC    CL8'&SYSDATE'           ASSEMBLE DATE.                   31000000
PROLOGUE STM   RETREG,BASEREG,12(SAVEREG)  SAVE CALLER'S REGISTERS.     31050000
         BALR  BASEREG,R0              ESTABLISH BASE REGISTER.         31100000
         DROP  ENTRYREG                DROP INITIAL BASE REG @WA24440   31150000
         USING *,BASEREG               ESTABLISH ADDRESSIBILTY          31200000
         LA    ENTRYREG,SAVEAREA       POINT TO MY SAVE AREA.           31250000
         ST    SAVEREG,4(,ENTRYREG)    SAVE ADDRESS OF CALLER'S SAVE    31300000
*                                          AREA.                        31350000
         ST    ENTRYREG,8(,SAVEREG)    SAVE ADDRESS OF MY SAVE AREA.    31400000
         LR    SAVEREG,ENTRYREG        POINT TO MY SAVE AREA.           31450000
         EJECT                                                          31500000
*                                                                       31550000
*--------------------------------------------------------------------*  31600000
*                                                                    *  31650000
*        BUILD VIRTUAL RESOURCE POOLS ABOVE AND BELOW 16MB LINE.     *  31700000
*                                                                    *  31750000
*--------------------------------------------------------------------*  31800000
*                                                                       31850000
BUILD1   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     31900000
         BLDVRP MF=(E,BLDABOVE)        GET RESOURCE POOL ABOVE 16MB.    31950000
         LTR   RETCODE,RETCODE         REQUEST COMPLETED?               32000000
         BZ    BUILD2                  YES, GO BUILD POOL BELOW 16MB.   32050000
         ABEND 100                     NO, ABEND WITH CODE U0100.       32100000
BUILD2   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     32150000
         BLDVRP MF=(E,BLDBELOW)        GET RESOURCE POOL BELOW 16MB.    32200000
         LTR   RETCODE,RETCODE         REQUEST COMPLETED?               32250000
         BZ    OPEN1                   YES, GO OPEN KSDS01.             32300000
         ABEND 100                     NO, ABEND WITH CODE U0100.       32350000
         EJECT                                                          32400000
*                                                                       32450000
*--------------------------------------------------------------------*  32500000
*                                                                    *  32550000
*        OPEN DFPS2IVP.KSDS01 TO VERIFY RECORDS ARE ACCESSIBLE.      *  32600000
*                                                                    *  32650000
*--------------------------------------------------------------------*  32700000
*                                                                       32750000
OPEN1    DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     32800000
         OPEN  (DIRACB)                LOGICALLY CONNECT KSDS01.        32850000
         LTR   RETCODE,RETCODE         KSDS01 OPEN OK?                  32900000
         BZ    OPEN1OK                 YES, GO VERIFY DATASET.          32950000
         ABEND 100                     NO, ABEND WITH CODE U0100.       33000000
*                                                                       33050000
*--------------------------------------------------------------------*  33100000
*                                                                    *  33150000
*        CALL SUBROUTINE TO VERIFY DFPS2IVP.KSDS01 IS ACCESSIBLE.    *  33200000
*                                                                    *  33250000
*--------------------------------------------------------------------*  33300000
*                                                                       33350000
OPEN1OK  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     33400000
         BAL   LINKREG,VERIFYIT        CALL SUBROUTINE TO VERIFY        33450000
*                                          DFPS2IVP.KSDS01.             33500000
CLOSE2   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     33550000
         CLOSE (DIRACB)                LOGICALLY DISCONNECT KSDS01.     33600000
         LTR   RETCODE,RETCODE         KSDS01 CLOSE OK?                 33650000
         BZ    DELPOOL1                YES, GO DELETE RESOURCE POOLS.   33700000
         ABEND 100                     NO, ABEND WITH CODE U0100.       33750000
         EJECT                                                          33800000
*                                                                       33850000
*--------------------------------------------------------------------*  33900000
*                                                                    *  33950000
*        DELETE RESOURCE POOLS AND TEST FOR SUCCESSFUL RUN.          *  34000000
*                                                                    *  34050000
*--------------------------------------------------------------------*  34100000
*                                                                       34150000
DELPOOL1 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     34200000
         DLVRP TYPE=LSR,SHRPOOL=POOL24 DELETE POOL BELOW 16MB.          34250000
         LTR   RETCODE,RETCODE         RESOURCE POOL DELETE OK?         34300000
         BZ    DELPOOL2                YES, GO DELETE RESOURCE POOL31.  34350000
         ABEND 100                     NO, ABEND WITH CODE U0100.       34400000
DELPOOL2 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     34450000
         DLVRP TYPE=LSR,SHRPOOL=POOL31 DELETE POOL ABOVE 16MB.          34500000
         LTR   RETCODE,RETCODE         RESOURCE POOL DELETE OK?         34550000
         BZ    DELETEOK                YES, GO SET SUCCESS RETURN CODE. 34600000
         ABEND 100                     NO, ABEND WITH CODE U0100.       34650000
DELETEOK DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     34700000
         SR    RETCODE,RETCODE         SET ZERO RETURN CODE.            34750000
         EJECT                                                          34800000
*                                                                       34850000
*--------------------------------------------------------------------*  34900000
*                                                                    *  34950000
*        STANDARD EXIT EPILOGUE. RESTORE CALLER'S REGISTERS AND      *  35000000
*        RETURN TO CALLER.                                           *  35050000
*                                                                    *  35100000
*--------------------------------------------------------------------*  35150000
*                                                                       35200000
EXIT     DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     35250000
         L     SAVEREG,4(,SAVEREG)     RESTORE CALLER'S SAVE AREA ADDR. 35300000
         L     RETREG,12(,SAVEREG)     RESTORE RETURN ADDRESS REGISTER. 35350000
         LM    R0,BASEREG,20(SAVEREG)  RESTORE ALL REGS. EXCEPT REG15.  35400000
         BR    RETREG                  RETURN TO CALLER.                35450000
         EJECT                                                          35500000
*                                                                       35550000
*--------------------------------------------------------------------*  35600000
*                                                                    *  35650000
*        VERIFY DFPS2IVP.KSDS01 CAN BE ACCESSED. GET RECORDS USING   *  35700000
*        DIRECT REQUESTS. COMPARE THE RECORDS READ WITH A MODEL      *  35750000
*        RECORD.  IF THE RECORDS MATCH THE LOOP IS EXECUTED AGAIN,   *  35800000
*        IF THE COMPARISON IS UNEQUAL THEN A USER 100 ABEND IS       *  35850000
*        ISSUED. AFTER THE LOOP IS EXECUTED THE DESIRED NUMBER OF    *  35900000
*        TIMES, CONTROL IS RETURNED TO THE MAIN ROUTINE.             *  35950000
*                                                                    *  36000000
*--------------------------------------------------------------------*  36050000
*                                                                       36100000
         EJECT                                                          36150000
VERIFYIT DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     36200000
         ST    LINKREG,LINKSAVE        SAVE RETURN ADDRESS.             36250000
         LA    COUNT,LOOPCNT           INITIALIZE LOOP COUNTER.         36300000
         LA    MAXRECS,NORECS-1        INIT. MAXIMUM RECORD KEY.        36350000
DIRLOOP  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     36400000
         SR    KEYREG,KEYREG           INIT. SEARCH ARGUMENT REGISTER.  36450000
         STCK  TIME                    GET TIME FROM TOD CLOCK.         36500000
         BC    CLOCKOK,TIMEOK          TIME VALID? YES, GO GET INDEX.   36550000
         B     DIRLOOP                 NO, GET TIME AGAIN.              36600000
TIMEOK   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     36650000
         IC    KEYREG,RECINDEX         GET ARBITRARY RECORD NUMBER.     36700000
VALIDREC DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     36750000
         CR    KEYREG,MAXRECS          VALID RECORD KEY?                36800000
         BNH   GETINDEX                YES, GO SET SEARCH ARGUMENT.     36850000
         SR    KEYREG,MAXRECS          GET ALTERNATE RECORD KEY.        36900000
         B     VALIDREC                GO TEST ALTERNATE RECORD KEY.    36950000
GETINDEX DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     37000000
         ST    KEYREG,KEY              UPDATE SEARCH ARGUMENT FIELD.    37050000
         MVC   TESTREC(RECLENG),RECORD INITIALIZE COMPARISON RECORD.    37100000
         GET   RPL=DIRRPL              GET RECORD USING DIRECT REQUEST. 37150000
         LTR   RETCODE,RETCODE         REQUEST ACCEPTED?                37200000
         BZ    COMPARE1                YES, GO COMPARE RECORD.          37250000
         ABEND 100                     NO, ABEND WITH CODE U0100.       37300000
COMPARE1 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     37350000
         CLC   TESTREC(RECLENG),RECORD ARE RECORDS EQUAL?               37400000
         BE    DECRCNT                 YES, GO DECREMENT LOOP COUNT.    37450000
         ABEND 100                     NO, ABEND WITH CODE U0100.       37500000
DECRCNT  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     37550000
         BCT   COUNT,DIRLOOP           DECREMENT LOOP COUNT.            37600000
*                                      IS COUNT ZERO? NO, CONTINUE.     37650000
TCLOSE   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     37700000
         CLOSE (DIRACB),TYPE=T         YES, PARTIALLY CLOSE KSDS01.     37750000
         LTR   RETCODE,RETCODE         KSDS01 CLOSE OK?                 37800000
         BZ    VEREXIT                 YES, GO EXIT VERIFY ROUTINE.     37850000
         ABEND 100                     NO, ABEND WITH CODE U0100.       37900000
VEREXIT  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     37950000
         L     LINKREG,LINKSAVE        RESTORE RETURN ADDRESS.          38000000
         BR    LINKREG                 RETURN TO MAIN ROUTINE.          38050000
         EJECT                                                          38100000
*                                                                       38150000
*--------------------------------------------------------------------*  38200000
*                                                                    *  38250000
*        CONSTANT AND STORAGE DEFINITIONS.                           *  38300000
*                                                                    *  38350000
*--------------------------------------------------------------------*  38400000
*                                                                       38450000
TIME     DS    0D                      TIME-OF-DAY CLOCK STORAGE.       38500000
         DS    CL6                     UNUSED.                          38550000
RECINDEX DS    XL1                     KEY TABLE RECORD INDEX.          38600000
         DS    CL1                     UNUSED.                          38650000
*                                                                       38700000
OPENMSG  DS    CL132                   OPEN ERROR MESSAGE AREA.         38750000
*                                                                       38800000
         DS    0F                      FULLWORD BOUNDARY ALIGNMENT.     38850000
TESTREC  DS    CL256                   RECORD COMPARISON MODEL.         38900000
*                                                                       38950000
         DS    0F                      FULLWORD BOUNDARY ALIGNMENT.     39000000
RECORD   DS    0CL256                  KSDS01 RECORD DESCRIPTION.       39050000
         DC    CL8'DFPS2IVP'           JOB NAME.                        39100000
KEY      DC    F'0'                    SEARCH KEY ARGUMENT.             39150000
         DC    CL4' '                  FILLER.                          39200000
         DC    4CL60' TEST DATA FOR DFPS2IVP'  FILLER.                  39250000
*                                                                       39300000
LINKSAVE DC    F'-1'                   INTERNAL LINKAGE RETURN ADDR.    39350000
*                                                                       39400000
SAVEAREA DC    18F'-1'                 REGISTER SAVE AREA.              39450000
         EJECT                                                          39500000
*                                                                       39550000
*--------------------------------------------------------------------*  39600000
*                                                                    *  39650000
*        VSAM CONTROL BLOCKS.                                        *  39700000
*                                                                    *  39750000
*--------------------------------------------------------------------*  39800000
*                                                                       39850000
BLDABOVE BLDVRP BUFFERS=(2048(4),4096(3),512(4)),                      X39900000
               KEYLEN=4,                                               X39950000
               STRNO=3,                                                X40000000
               TYPE=LSR,                                               X40050000
               SHRPOOL=15,                                             X40100000
               LOC=ANY,                                                X40150000
               MF=L                                                     40200000
         EJECT                                                          40250000
*                                                                       40300000
BLDBELOW BLDVRP BUFFERS=(2048(4),4096(3),512(6)),                      X40350000
               KEYLEN=4,                                               X40400000
               STRNO=3,                                                X40450000
               TYPE=LSR,                                               X40500000
               SHRPOOL=5,                                              X40550000
               LOC=BELOW,                                              X40600000
               MF=L                                                     40650000
         EJECT                                                          40700000
*                                                                       40750000
DIRACB   ACB   AM=VSAM,                                                X40800000
               DDNAME=KSDS01,                                          X40850000
               BUFND=3,                                                X40900000
               BUFNI=2,                                                X40950000
               MACRF=(KEY,DDN,SKP,DIR,OUT,LSR),                        X41000000
               MAREA=OPENMSG,                                          X41050000
               SHRPOOL=POOL31,                                         X41100000
               MLEN=132                                                 41150000
         EJECT                                                          41200000
*                                                                       41250000
DIRRPL   RPL   AM=VSAM,                                                X41300000
               ACB=DIRACB,                                             X41350000
               AREA=RECORD,                                            X41400000
               AREALEN=RECLENG,                                        X41450000
               ARG=KEY,                                                X41500000
               KEYLEN=KEYLENG,                                         X41550000
               OPTCD=(KEY,DIR,FWD,SYN,UPD),                            X41600000
               RECLEN=RECLENG                                           41650000
*                                                                       41700000
         END                                                            41750000
/*                                                                      41800000
//*                                                                     41850000
//********************************************************************* 41900000
//*                                                                   * 41950000
//*           ASSEMBLE DFPSIVP3                                       * 42000000
//*                                                                   * 42050000
//********************************************************************* 42100000
//*                                                                     42150000
//ASSEM3  EXEC HLASMC,REGION.C=512K,COND.C=(0,NE,ASSEM1.C), /*WA29697*/ 42225000
//             PARM.C='NOOBJECT,LINECOUNT(55),DECK'        /*@WA24440*/ 42250000
//C.SYSPUNCH DD  DSN=&ASM3OBJ,UNIT=SYSDA,DISP=(NEW,PASS),  /*@YA06851*/ 42300000
//             SPACE=(TRK,(1,1),RLSE)                                   42350000
//C.SYSIN    DD  *                                         /*@YA06851*/ 42400000
DFPSIVP3 TITLE 'DFPSIVP3 -- VSAM 31 BIT MULTIPLE LSR POOLS TEST'        42450000
DFPSIVP3 CSECT                                                          42500000
DFPSIVP3 AMODE 31                                                       42550000
DFPSIVP3 RMODE 24                                                       42600000
*                                                                       42650000
*--------------------------------------------------------------------*  42700000
*                                                                    *  42750000
*        REGISTER EQUATES.                                           *  42800000
*                                                                    *  42850000
*--------------------------------------------------------------------*  42900000
*                                                                       42950000
R0       EQU   0                       REGISTER 0.                      43000000
COUNT    EQU   2                       LOOP ITERATION COUNTER.          43050000
KEYREG   EQU   3                       SEARCH KEY ARGUMENT REGISTER.    43100000
LINKREG  EQU   11                      INTERNAL SUBROUTINE LINKAGE.     43150000
BASEREG  EQU   12                      BASE REGISTER.                   43200000
SAVEREG  EQU   13                      SAVE AREA REGISTER.              43250000
RETREG   EQU   14                      CALLER'S RETURN ADDRESS.         43300000
ENTRYREG EQU   15                      DFPSIVP3'S ENTRY ADDRESS.        43350000
RETCODE  EQU   15                      RETURN CODE.                     43400000
         EJECT                                                          43450000
*                                                                       43500000
*--------------------------------------------------------------------*  43550000
*                                                                    *  43600000
*        CONSTANT EQUATES                                            *  43650000
*                                                                    *  43700000
*--------------------------------------------------------------------*  43750000
*                                                                       43800000
POOL24   EQU   5                       RESOURCE POOL ID BELOW 16MB.     43850000
POOL31   EQU   15                      RESOURCE POOL ID ABOVE 16MB.     43900000
NORECS   EQU   50                      NUMBER OF RECORDS TO BE LOADED.  43950000
KEYLENG  EQU   4                       SEARCH ARGUMENT LENGTH.          44000000
RECLENG  EQU   256                     RECORD LENGTH.                   44050000
LOOPCNT  EQU   3                       KSDS VERIFY LOOP COUNT.          44100000
         EJECT                                                          44150000
*                                                                       44200000
*--------------------------------------------------------------------*  44250000
*                                                                    *  44300000
*        STANDARD ENTRY PROLOGUE. SAVE AREA CHAINING, ESTABLISH      *  44350000
*        BASE REGISTER AND ADDRESSIBILITY.                           *  44400000
*                                                                    *  44450000
*--------------------------------------------------------------------*  44500000
*                                                                       44550000
         USING DFPSIVP3,ENTRYREG       ESTABLISH ADDRESSIBILITY.        44600000
         B     PROLOGUE                BRANCH AROUND EYECATCHER.        44650000
         DC    CL8'DFPSIVP3'           MODULE NAME.                     44700000
         DC    CL8'&SYSDATE'           ASSEMBLE DATE.                   44750000
PROLOGUE STM   RETREG,BASEREG,12(SAVEREG)  SAVE CALLER'S REGISTERS.     44800000
         BALR  BASEREG,R0              ESTABLISH BASE REGISTER.         44850000
         DROP  ENTRYREG                DROP INITIAL BASE REG @WA24440   44900000
         USING *,BASEREG               ESTABLISH ADDRESSIBILTY          44950000
         LA    ENTRYREG,SAVEAREA       POINT TO MY SAVE AREA.           45000000
         ST    SAVEREG,4(,ENTRYREG)    SAVE ADDRESS OF CALLER'S SAVE    45050000
*                                          AREA.                        45100000
         ST    ENTRYREG,8(,SAVEREG)    SAVE ADDRESS OF MY SAVE AREA.    45150000
         LR    SAVEREG,ENTRYREG        POINT TO MY SAVE AREA.           45200000
         EJECT                                                          45250000
*                                                                       45300000
*--------------------------------------------------------------------*  45350000
*                                                                    *  45400000
*        BUILD VIRTUAL RESOURCE POOLS ABOVE AND BELOW 16MB LINE.     *  45450000
*                                                                    *  45500000
*--------------------------------------------------------------------*  45550000
*                                                                       45600000
BUILD1   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     45650000
         BLDVRP MF=(E,BLDABOVE)        GET RESOURCE POOL ABOVE 16MB.    45700000
         LTR   RETCODE,RETCODE         REQUEST COMPLETED?               45750000
         BZ    BUILD2                  YES, GO BUILD POOL BELOW 16MB.   45800000
         ABEND 100                     NO, ABEND WITH CODE U0100.       45850000
BUILD2   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     45900000
         BLDVRP MF=(E,BLDBELOW)        GET RESOURCE POOL BELOW 16MB.    45950000
         LTR   RETCODE,RETCODE         REQUEST COMPLETED?               46000000
         BZ    OPEN1                   YES, GO OPEN KSDS01.             46050000
         ABEND 100                     NO, ABEND WITH CODE U0100.       46100000
         EJECT                                                          46150000
*                                                                       46200000
*--------------------------------------------------------------------*  46250000
*                                                                    *  46300000
*        OPEN DFPS2IVP.KSDS01 TO VERIFY RECORDS ARE ACCESSIBLE.      *  46350000
*                                                                    *  46400000
*--------------------------------------------------------------------*  46450000
*                                                                       46500000
OPEN1    DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     46550000
         OPEN  (SEQACB)                LOGICALLY CONNECT KSDS01.        46600000
         LTR   RETCODE,RETCODE         KSDS01 OPEN OK?                  46650000
         BZ    OPEN1OK                 YES, GO VERIFY DATASET.          46700000
         ABEND 100                     NO, ABEND WITH CODE U0100.       46750000
*                                                                       46800000
*--------------------------------------------------------------------*  46850000
*                                                                    *  46900000
*        CALL SUBROUTINE TO VERIFY DFPS2IVP.KSDS01 IS ACCESSIBLE.    *  46950000
*                                                                    *  47000000
*--------------------------------------------------------------------*  47050000
*                                                                       47100000
OPEN1OK  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     47150000
         LA    COUNT,LOOPCNT           GET NUMBER OF TIMES TO VERIFY    47200000
*                                          DATASET.                     47250000
VERLOOP  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     47300000
         BAL   LINKREG,VERIFYIT        CALL SUBROUTINE TO VERIFY        47350000
*                                          DFPS2IVP.KSDS01.             47400000
         BCT   COUNT,VERLOOP           GO EXECUTE VERIFY SUBROUTINE     47450000
*                                          UNTIL LOOP COUNT IS ZERO.    47500000
CLOSE2   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     47550000
         CLOSE (SEQACB)                LOGICALLY DISCONNECT KSDS01.     47600000
         LTR   RETCODE,RETCODE         KSDS01 CLOSE OK?                 47650000
         BZ    DELPOOL1                YES, GO DELETE RESOURCE POOLS.   47700000
         ABEND 100                     NO, ABEND WITH CODE U0100.       47750000
         EJECT                                                          47800000
*                                                                       47850000
*--------------------------------------------------------------------*  47900000
*                                                                    *  47950000
*        DELETE RESOURCE POOLS AND TEST FOR SUCCESSFUL RUN.          *  48000000
*                                                                    *  48050000
*--------------------------------------------------------------------*  48100000
*                                                                       48150000
DELPOOL1 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     48200000
         DLVRP TYPE=LSR,SHRPOOL=POOL24 DELETE POOL BELOW 16MB.          48250000
         LTR   RETCODE,RETCODE         RESOURCE POOL DELETE OK?         48300000
         BZ    DELPOOL2                YES, GO DELETE RESOURCE POOL31.  48350000
         ABEND 100                     NO, ABEND WITH CODE U0100.       48400000
DELPOOL2 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     48450000
         DLVRP TYPE=LSR,SHRPOOL=POOL31 DELETE POOL ABOVE 16MB.          48500000
         LTR   RETCODE,RETCODE         RESOURCE POOL DELETE OK?         48550000
         BZ    DELETEOK                YES, GO CHECK FOR SUCCESS RUN.   48600000
         ABEND 100                     NO, ABEND WITH CODE U0100.       48650000
DELETEOK DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     48700000
         SR    RETCODE,RETCODE         SET ZERO RETURN CODE.            48750000
         EJECT                                                          48800000
*                                                                       48850000
*--------------------------------------------------------------------*  48900000
*                                                                    *  48950000
*        STANDARD EXIT EPILOGUE. RESTORE CALLER'S REGISTERS AND      *  49000000
*        RETURN TO CALLER.                                           *  49050000
*                                                                    *  49100000
*--------------------------------------------------------------------*  49150000
*                                                                       49200000
EXIT     DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     49250000
         L     SAVEREG,4(,SAVEREG)     RESTORE CALLER'S SAVE AREA ADDR. 49300000
         L     RETREG,12(,SAVEREG)     RESTORE RETURN ADDRESS REGISTER. 49350000
         LM    R0,BASEREG,20(SAVEREG)  RESTORE ALL REGS. EXCEPT REG15.  49400000
         BR    RETREG                  RETURN TO CALLER.                49450000
         EJECT                                                          49500000
*                                                                       49550000
*--------------------------------------------------------------------*  49600000
*                                                                    *  49650000
*        VERIFY DFPS2IVP.KSDS01 CAN BE ACCESSED. GET RECORDS USING   *  49700000
*        BACKWARD REQUESTS. COMPARE THE RECORDS READ WITH A MODEL    *  49750000
*        RECORD.  IF THE RECORDS MATCH THE LOOP IS EXECUTED AGAIN,   *  49800000
*        IF THE COMPARISON IS UNEQUAL A USER 100 ABEND IS ISSUED.    *  49850000
*        THE DATASET IS READ UNTIL EOF IS REACHED, AND THEN          *  49900000
*        TEMPORARILY CLOSED.  CONTROL IS THEN RETURNED TO MAIN       *  49950000
*        ROUTINE.                                                    *  50000000
*                                                                    *  50050000
*--------------------------------------------------------------------*  50100000
*                                                                       50150000
VERIFYIT DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     50200000
         ST    LINKREG,LINKSAVE        SAVE RETURN ADDRESS.             50250000
         LA    KEYREG,NORECS-1         INIT. SEARCH ARGUMENT REGISTER.  50300000
         ST    KEYREG,KEY              UPDATE SEARCH ARGUMENT FIELD.    50350000
         POINT RPL=BWDRPL              POSITION VSAM.                   50400000
         LTR   RETCODE,RETCODE         REQUEST ACCEPTED?                50450000
         BZ    GETLOOP                 YES, GO GET RECORD.              50500000
         ABEND 100                     NO, ABEND WITH CODE U0100.       50550000
GETLOOP  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     50600000
         ST    KEYREG,KEY              UPDATE SEARCH ARGUMENT FIELD.    50650000
         MVC   TESTREC(RECLENG),RECORD INITIALIZE COMPARISON RECORD.    50700000
         GET   RPL=BWDRPL              GET RECORD USING BACKWARD        50750000
*                                          SEQUENTIAL REQUESTS.         50800000
         LTR   RETCODE,RETCODE         REQUEST ACCEPTED?                50850000
         BZ    COMPARE1                YES, GO COMPARE RECORD.          50900000
         ABEND 100                     NO, ABEND WITH CODE U0100.       50950000
COMPARE1 DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     51000000
         CLC   TESTREC(RECLENG),RECORD     ARE RECORDS EQUAL?           51050000
         BE    DECRKEY                 YES, GO DECREMENT KEY TABLE IX.  51100000
         ABEND 100                     NO, ABEND WITH CODE U0100.       51150000
DECRKEY  DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     51200000
         BCTR  KEYREG,R0               DECREMENT SEARCH ARG. BY 1.      51250000
         B     GETLOOP                 DECREMENT LOOP COUNT.            51300000
*                                      IS COUNT ZERO? NO, CONTINUE.     51350000
TCLOSE   DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     51400000
         CLOSE (SEQACB),TYPE=T         YES, PARTIALLY CLOSE KSDS01.     51450000
         LTR   RETCODE,RETCODE         KSDS01 CLOSE OK?                 51500000
         BZ    TCLOSEOK                YES, GO RETURN TO MAIN ROUTINE.  51550000
         ABEND 100                     NO, ABEND WITH CODE U0100.       51600000
TCLOSEOK DS    0H                      HALFWORD BOUNDARY ALIGNMENT.     51650000
         L     LINKREG,LINKSAVE        RESTORE RETURN ADDRESS.          51700000
         BR    LINKREG                 RETURN TO MAIN ROUTINE.          51750000
         EJECT                                                          51800000
*                                                                       51850000
*--------------------------------------------------------------------*  51900000
*                                                                    *  51950000
*        CONSTANT AND STORAGE DEFINITIONS.                           *  52000000
*                                                                    *  52050000
*--------------------------------------------------------------------*  52100000
*                                                                       52150000
OPENMSG  DS    CL132                   OPEN ERROR MESSAGE AREA.         52200000
*                                                                       52250000
         DS    0F                      FULLWORD BOUNDARY ALIGNMENT.     52300000
TESTREC  DS    CL256                   RECORD COMPARISON MODEL.         52350000
*                                                                       52400000
         DS    0F                      FULLWORD BOUNDARY ALIGNMENT.     52450000
RECORD   DS    0CL256                  KSDS01 RECORD DESCRIPTION.       52500000
         DC    CL8'DFPS2IVP'           TESTCASE NAME.                   52550000
KEY      DC    F'0'                    SEARCH KEY ARGUMENT.             52600000
         DC    CL4' '                  FILLER.                          52650000
         DC    4CL60' TEST DATA FOR DFPS2IVP'  FILLER.                  52700000
*                                                                       52750000
LINKSAVE DC    F'-1'                   INTERNAL LINKAGE RETURN ADDR.    52800000
*                                                                       52850000
SAVEAREA DC    18F'-1'                 REGISTER SAVE AREA.              52900000
         EJECT                                                          52950000
*                                                                       53000000
*--------------------------------------------------------------------*  53050000
*                                                                    *  53100000
*        VSAM CONTROL BLOCKS.                                        *  53150000
*                                                                    *  53200000
*--------------------------------------------------------------------*  53250000
*                                                                       53300000
BLDABOVE BLDVRP BUFFERS=(2048(4),4096(3)),                             X53350000
               KEYLEN=4,                                               X53400000
               STRNO=3,                                                X53450000
               TYPE=LSR,                                               X53500000
               SHRPOOL=15,                                             X53550000
               LOC=ANY,                                                X53600000
               MF=L                                                     53650000
         EJECT                                                          53700000
*                                                                       53750000
BLDBELOW BLDVRP BUFFERS=(2048(4),4096(3)),                             X53800000
               KEYLEN=4,                                               X53850000
               STRNO=3,                                                X53900000
               TYPE=LSR,                                               X53950000
               SHRPOOL=5,                                              X54000000
               LOC=BELOW,                                              X54050000
               MF=L                                                     54100000
         EJECT                                                          54150000
*                                                                       54200000
SEQACB   ACB   AM=VSAM,                                                X54250000
               DDNAME=KSDS01,                                          X54300000
               BUFND=3,                                                X54350000
               BUFNI=2,                                                X54400000
               MACRF=(KEY,DDN,SEQ,IN,LSR),                             X54450000
               SHRPOOL=POOL31,                                         X54500000
               MAREA=OPENMSG,                                          X54550000
               EXLST=EXLST1,                                           X54600000
               MLEN=132                                                 54650000
         EJECT                                                          54700000
*                                                                       54750000
BWDRPL   RPL   AM=VSAM,                                                X54800000
               ACB=SEQACB,                                             X54850000
               AREA=RECORD,                                            X54900000
               AREALEN=RECLENG,                                        X54950000
               ARG=KEY,                                                X55000000
               OPTCD=(KEY,SEQ,BWD,LRD,SYN,NUP),                        X55050000
               KEYLEN=KEYLENG,                                         X55100000
               RECLEN=RECLENG                                           55150000
         EJECT                                                          55200000
*                                                                       55250000
EXLST1   EXLST AM=VSAM,                                                X55300000
               EODAD=TCLOSE                                             55350000
*                                                                       55400000
         END                                                            55450000
/*                                                                      55500000
//*                                                                     55550000
//********************************************************************* 55600000
//*                                                                   * 55650000
//*       LINK EDIT THE DFPS2IVP OBJECT MODULES.                      * 55700000
//*                                                                   * 55750000
//********************************************************************* 55800000
//*                                                                     55850000
//LINK1   EXEC PGM=HEWLH096,PARM='XREF,LIST,LET',COND=(0,NE)            55900000
//SYSPRINT DD  SYSOUT=*                                                 55950000
//SYSUT1   DD  UNIT=SYSDA,SPACE=(1024,(50,20,1),RLSE)                   56000000
//SYSLMOD  DD  DSN=DFPS2IVP.TEMPLIB,DISP=SHR                            56050000
//OBJ1IN   DD  DSN=&ASM1OBJ,DISP=(OLD,PASS)                             56100000
//OBJ2IN   DD  DSN=&ASM2OBJ,DISP=(OLD,PASS)                             56150000
//OBJ3IN   DD  DSN=&ASM3OBJ,DISP=(OLD,PASS)                             56200000
//SYSLIN   DD  *                                                        56250000
 INCLUDE OBJ1IN                                                         56300000
 MODE AMODE(31),RMODE(24)                                               56350000
 NAME DFPSIVP1(R)                                                       56400000
 INCLUDE OBJ2IN                                                         56450000
 MODE AMODE(31),RMODE(24)                                               56500000
 NAME DFPSIVP2(R)                                                       56550000
 INCLUDE OBJ3IN                                                         56600000
 MODE AMODE(31),RMODE(24)                                               56650000
 NAME DFPSIVP3(R)                                                       56700000
/*                                                                      56750000
//********************************************************************* 56800000
//*   THE FOLLOWING STEP WILL HOLD THE NEXT JOB(S) FROM BEING         * 56850000
//*   SUBMITTED UNTIL THE PRECEDING JOB IS COMPLETELY EXECUTED.       * 56900000
//********************************************************************* 56950000
//HOLD2   EXEC PGM=IEBGENER                                             57000000
//SYSPRINT DD  SYSOUT=*                                                 57050000
//SYSIN  DD  DUMMY                                                      57100000
//SYSUT2  DD SYSOUT=(A,INTRDR)                                          57150000
//SYSUT1  DD DATA,DLM=$B                                                57200000
//DFPS2IV3 JOB (DFPS2IV3),IVP3,MSGLEVEL=(1,1),MSGCLASS=A,CLASS=A        57250000
//*                                                                     57300000
//********************************************************************* 57350000
//*                                                                   * 57400000
//*      EXECUTE TEST PROGRAM DFPSIVP1.                               * 57450000
//*                                                                   * 57500000
//********************************************************************* 57550000
//*                                                                     57600000
//EXECIVP1 EXEC PGM=DFPSIVP1,REGION=1024K                               57650000
//STEPLIB  DD  DSN=DFPS2IVP.TEMPLIB,DISP=SHR                            57700000
//KSDS01   DD  DSN=DFPS2IVP.KSDS01,DISP=SHR                             57750000
//SYSUDUMP DD  SYSOUT=*                                                 57800000
//*                                                                     57850000
//********************************************************************* 57900000
//*                                                                   * 57916600
//*      EXECUTE TEST PROGRAM DFPSIVP2.                               * 57933200
//*                                                                   * 57950000
//********************************************************************* 57959000
//*                                                                     57968000
//EXECIVP2 EXEC PGM=DFPSIVP2,COND=(0,NE),REGION=1024K                   57977000
//STEPLIB  DD  DSN=DFPS2IVP.TEMPLIB,DISP=SHR                            57986000
//KSDS01   DD  DSN=DFPS2IVP.KSDS01,DISP=SHR                             57995000
//SYSUDUMP DD  SYSOUT=*                                                 58004000
//*                                                                     58013000
//********************************************************************* 58022000
//*                                                                   * 58031000
//*      EXECUTE TEST PROGRAM DFPSIVP3.                               * 58040000
//*                                                                   * 58050000
//********************************************************************* 58100000
//*                                                                     58150000
//EXECIVP3 EXEC PGM=DFPSIVP3,COND=(0,NE),REGION=1024K                   58200000
//STEPLIB  DD  DSN=DFPS2IVP.TEMPLIB,DISP=SHR                            58250000
//KSDS01   DD  DSN=DFPS2IVP.KSDS01,DISP=SHR                             58300000
//SYSUDUMP DD  SYSOUT=*                                                 58350000
//LINK2   EXEC PGM=HEWLH096,PARM='XREF,LIST,LET',COND=(0,NE)            58950000
//SYSPRINT DD  SYSOUT=*                                                 59000000
//SYSUT1   DD  UNIT=SYSDA,SPACE=(1024,(50,20,1),RLSE)                   59050000
//SYSLMOD  DD  DSN=DFPS2IVP.TEMPLIB,DISP=SHR                            59100000
//SYSLIN DD *                                                           59150000
ESD          VIOIDAW                                               59200000
TXT          00VIOIDAW   83.034 }	^{&}s\s&\}  59250000
TXT         wkZ& ; t t}    &  &tm-tmk-k-	  59300000
TXT         -K-uk -(K-+-(K -ty   &  &tqtq q&t59350000
TXT   y       q&tkk	  Kuk (K+(K tZ\~}\u59400000
TXT   \      &\KuKu\s0uu&0Ku\s v& Kv\s59450000
TXT        vd&;tvKuv\sv&tmK v\sw59500000
TXT  &      &tq | Ku \sKzkz^&z&&\s-59550000
TXT  h      z4&-\s~h~d                                  59600000
TXT        "  0~wK|w& H w0	  & t ~~{  59650000
TXT  Q       Q\s}}q}s~\ ^ U-hi{K59700000
TXT        -qst s  U ^qts8P59750000
TXT           n"ss\s&qs8}Kt t 59800000
TXT        t@q}                                          59850000
TXT                                                            59900000
TXT          	&  	H  	}  	M                                        59950000
TXT  {        QDATA5-----55555-----55555-----55555-----55555-----5560000000
TXT  8      555-----DATA5DATA6-----66666-----66666-----66666-----66660050000
TXT        66-----66666-----DATA6EEEEFFFF                          60100000
TXT         +   	         &                                60150000
TXT         AAAADATA1-----11111-----11111-----11111-----11111---60200000
TXT        --11111-----DATA1       	 {     Y   0   460250000
TXT  U                                                             60300000
TXT         BBBBDATA2-----22222-----22222-----22222-----22222---60350000
TXT  	      --22222-----DATA2    Y   	 	       &            60400000
TXT  	       CCCCDATA3-----33333-----33333-----33333-----33333---60450000
TXT  	      --33333-----DATA3    +   	 	     ud   yd   60500000
TXT  	D                                                            60550000
TXT  	       DDDDDATA4-----44444-----44444-----44444-----44444---60600000
TXT        --44444-----DATA4    	H   	      ^  & +   	 60650000
TXT             d   d                                 60700000
TXT  y                                                              60750000
TXT  \                                                              60800000
TXT                                                                60850000
TXT  &                                                              60900000
TXT  h                                                              60950000
TXT  {                                                              61000000
TXT  8                                                              61050000
TXT                                                                61100000
TXT                                                                61150000
TXT                                                                61200000
TXT  Q                                                              61250000
TXT                                                                61300000
TXT                                                                61350000
TXT                                                                61400000
TXT                                                                61450000
TXT  }       H   	 }     y    8        q    Y   61500000
TXT             H   	      h   H   	           61550000
TXT          {       H   	 &   k    z     -    61600000
TXT            EEEE                                         61650000
TXT  q        ^                                                    61700000
TXT  u                                                              61750000
TXT  ^                                           DD1      }    61800000
TXT  Y                                      SYSPRINT  &      61850000
TXT           &                &                              61900000
RLD              Q 5 9     u y  {  /61950000
RLD               A I J R  	 	 	 	~ 	z 	 	62000000
RLD              	A         J R  Z62050000
RLD              1 9           62100000
RLD              /   ` h q                            62150000
END                           15734AS100 050183035                    62200000
 NAME VIOIDAW(R)                                                        62250000
/*                                                                      62258300
//*                                                                     62266600
//********************************************************************* 62274900
//*                                                                   * 62283200
//*      EXECUTE TEST PROGRAM VIOIDAW.                                * 62291500
/*                                                                      62300000
//*                                                                     62350000
//********************************************************************* 62400000
//*                                                                   * 62450000
//*      EXECUTE TEST PROGRAM VIOIDAW.                                * 62500000
//*                                                                   * 62550000
//********************************************************************* 62600000
//*                                                                     62650000
//VIOTEST EXEC PGM=VIOIDAW,COND=(0,NE),REGION=1024K                     62700000
//STEPLIB  DD  DSN=DFPS2IVP.TEMPLIB,DISP=SHR                            62750000
//*                                                                     62800000
//DD1 DD DSN=&&VIODSN,DISP=(,DELETE),SPACE=(TRK,(4,4)),UNIT=SYSVIO      62850000
//SYSPRINT DD  SYSOUT=*                                                 62862500
//SYSUDUMP DD  SYSOUT=*                                                 62875000
//*                                                                     62887500
//********************************************************************* 62900000
//*                                                                   * 62912500
//*      CLEAN UP TEMPORARY LOAD LIBRARY                              * 62925000
//*                                                                   * 62937500
//********************************************************************* 62950000
//*                                                                     62962500
//CLEANUPT EXEC PGM=IEFBR14,COND=EVEN                                   62975000
//LOADDD   DD  DSN=DFPS2IVP.TEMPLIB,DISP=(OLD,DELETE)                   62987500
//*                                                                     63000000
//********************************************************************* 63050000
//*                                                                   * 63100000
//*      PRINT AND DELETE ICFCATALOG WITH DFPS2IVP.KSDS01             * 63150000
//*                                                                   * 63200000
//********************************************************************* 63250000
//*                                                                     63300000
//CLEANUP2 EXEC PGM=IDCAMS,COND=EVEN                                    63350000
//SYSPRINT DD  SYSOUT=*                                                 63400000
//*                                                                     63450000
//KSDS01   DD  DSN=DFPS2IVP.KSDS01,DISP=SHR                             63550000
//SYSIN    DD  *                                                        63600000
                                                                        63650000
 /**************************************************************/       63700000
 /* THE PREVIOUS 31-BIT VIO TEST Z'S OUT A BUFFER AREA AND     */       63750000
 /* WRITES OUT DATA1 THRU DATA6.                               */       63800000
 /* VERIFY THAT DATA1 THRU DATA6 WERE WRITTEN OUT SUCCESSFULLY */       63850000
 /* AND THAT THE COND CODE IS ZERO.                            */       63900000
 /**************************************************************/       63950000
                                                                        64000000
 /*************************************************************/        64050000
 /*  CLEANUP2                                                 */        64100000
 /*************************************************************/        64150000
 /*   PRINT THE DATASET DFPS2IVP.KSDS01. THIS STEP SHOULD     */        64200000
 /*   BE SUCCESSFUL. FIFTY (50) RECORDS SHOULD BE PROCESSED   */        64250000
 /*   ANS SHOULD HAVE KEYS X'00' TO X'31'.           @YA22710 */        64300000
 /*************************************************************/        64350000
                                                                        64400000
    PRINT -                                                             64450000
       INFILE(KSDS01) -                                                 64500000
       OUTFILE(SYSPRINT) -                                              64550000
       DUMP                                                             64600000
                                                                        64650000
 /********************************************************************/ 64700000
 /*   CLEANUP2                                                       */ 64750000
 /********************************************************************/ 64800000
 /*     DELETE ICF UCAT & KSDS  FROM SCRATCH PACK FOR CLEANUP.       */ 64850000
 /*     EXPECT SUCCESSFUL COMPLETION OF THIS STEP.                   */ 64900000
 /********************************************************************/ 64950000
                                                                        65000000
  DELETE (DFPS2IVP.KSDS01) PURGE                                        65050000
                                                                        65100000
  DELETE DFS2UCAT UCAT FORCE                                            65150000
/*                                                                      65200000
$B                                                                      65250000
$A                                                                      65300000
